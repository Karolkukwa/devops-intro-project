{"openapi":"3.0.0","info":{"title":"Reports API","description":"API pobierania raportow","version":"1.0.0"},"servers":[{"url":"/"}],"paths":{"/reports/{reportID}":{"get":{"summary":"Pobierz raport po ID","parameters":[{"name":"reportID","in":"path","description":"Numeryczny ID raportu","required":true,"style":"simple","explode":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"Znaleziono raport","content":{"application/pdf":{"schema":{"type":"string","format":"binary"}}}},"404":{"description":"Nie znaleziono raportu","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReportNotFoundMessage"}}}}}}},"/verifications/whitelist":{"post":{"summary":"Sprawdzenie whitelisty podatnikow VAT","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WhitelistVerificationInput"}}},"required":true},"responses":{"201":{"description":"Zweryfikowano podatnika VAT","content":{"application/json":{"schema":{"$ref":"#/components/schemas/WhitelistVerificationOutput"}}}},"422":{"description":"Niekompletne dane","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorMessage"}}}},"404":{"description":"Nie zwrocono sygnalu z crif","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorMessage"}}}}}}},"/verifications/transactions":{"post":{"summary":"Weryfikacja transakcji","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KlopsVerificationTransactionInput"}}},"required":true},"responses":{"201":{"description":"Zweryfikowano klienta","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KlopsVerificationTransactionOutput"}}}},"422":{"description":"Niekompletne dane","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorMessage"}}}}}}},"/batchReport":{"get":{"summary":"Pobierz raport dot. odpytań do CRIF","parameters":[{"name":"from","in":"query","description":"Data początkowa zakresu odpytań w formacie 2020-02-27T12:01:28Z","required":false,"style":"form","explode":true,"schema":{"type":"string","format":"date-time"}},{"name":"to","in":"query","description":"Data końcowa zakresu odpytań w formacie 2020-02-27T12:01:28Z","required":false,"style":"form","explode":true,"schema":{"type":"string","format":"date-time"}},{"name":"nip","in":"query","description":"Poszukiwany NIP","required":false,"style":"form","explode":true,"schema":{"type":"string"}},{"name":"pesel","in":"query","description":"Poszukiwany PESEL","required":false,"style":"form","explode":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Wygenerowano","content":{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{"schema":{"type":"string","format":"binary"}}}}}}}},"components":{"schemas":{"ReportNotFoundMessage":{"type":"object","properties":{"message":{"type":"string","description":"Tresc komunikatu","example":"Report with ID 1238345797897324 not found"}}},"WhitelistVerificationInput":{"required":["bankAccountNumber","nip","referenceNumber"],"type":"object","properties":{"nip":{"type":"string","description":"NIP podmiotu","example":"7172693263"},"bankAccountNumber":{"type":"string","description":"Numer rachunku bankowego podmiotu","example":"0000999877665432233344"},"referenceNumber":{"type":"string","description":"Numer referencyjny transacji (rozumiany jako identyfikator zapytania podmiotu do whitelisty) np. tytul weryfikowanej faktury","example":"Faktura VAT nr 9/2019"},"vatMargin":{"type":"boolean","description":"informacja czy faktura jest VAT MARZA","example":true}}},"WhitelistVerificationOutput":{"type":"object","properties":{"result":{"$ref":"#/components/schemas/Signal"},"reportUrl":{"type":"string","description":"Link do szczegolowego raportu"},"accountSubresult":{"$ref":"#/components/schemas/Signal"},"nipSubresult":{"$ref":"#/components/schemas/Signal"}},"description":"result - ostateczny wynik weryfikacji\nsubresult - Skladowa wyniku\nOstateczny weryfikacji wyliczany jest z jego skladowych.\nMamy nastepujace skladowe:\n accountSubresult - wynik dla weryfikacji konta\n nipSubresult - wynik dla weryfikacji numeru nip\n"},"Signal":{"type":"string","description":"Wynik weryfikacji (RED, GREEN, UNVERIFIABLE)","enum":["RED","GREEN","UNVERIFIABLE"]},"ErrorMessage":{"type":"object","properties":{"message":{"type":"string","description":"error message"},"details":{"type":"string","description":"error details"}}},"KlopsVerificationTransactionInput":{"required":["clientNip","clientRegon","clientType","legalForm","sourceSystem","supplierNip","transactionNumber","userKey"],"type":"object","properties":{"transactionNumber":{"type":"string","description":"Numer transakcji","example":"TRA/A1234-3512"},"userKey":{"type":"string","description":"Uzytkownik wysylajacy wniosek CorpKey","example":"key"},"clientNip":{"type":"string","description":"NIP klienta","example":"4235186392"},"clientName":{"type":"string","description":"Nazwa frimy klienta","example":"Kalosze COMP"},"supplierNip":{"type":"string","description":"NIP dostawcy","example":"3192221074"},"isSupplierTrusted":{"type":"boolean","description":"Czy dostawca zaufany","example":true},"consentIssueDate":{"type":"string","description":"Data wyrazenia zgody 1.1","format":"date"},"clientRegon":{"type":"string","description":"Regon klienta","example":"531442617"},"affiliatedEntities":{"type":"array","items":{"$ref":"#/components/schemas/KlopsVerificationTransactionInputAffiliatedEntity"}},"legalForm":{"$ref":"#/components/schemas/LegalForm"},"clientType":{"type":"string","description":"# Segment klienta\nBIG - Korporacja\n\nCB - Strategiczny\n\nRT - Detal\n\nMID - Korporacja\n","example":"BIG","enum":["BIG","CB","RT","MID"]},"isClientActive":{"type":"boolean","example":true},"sourceSystem":{"type":"string","description":"Identyfikator systemu zlecajagego"}}},"KlopsVerificationTransactionInputAffiliatedEntity":{"required":["entityType"],"type":"object","properties":{"entityType":{"type":"string","description":"# Typ podmiotu powiazanego\nLEGAL_ENTITY - osoba prawna\n\nNATURAL_PERSON - osoba fizyczna\n","enum":["LEGAL_ENTITY","NATURAL_PERSON"]},"pesel":{"type":"string","description":"Pesel podmiotu powiazanego - obligatoryjne, gdy osoba fizyczna"},"name":{"type":"string","description":"Imie podmiotu powiazanego","example":"Marek"},"surname":{"type":"string","description":"Nazwisko podmiotu powiazanego - obligatoryjne, gdy osoba fizyczna","example":"Hunter"},"documentType":{"$ref":"#/components/schemas/DocumentTypeEnum"},"documentNumber":{"type":"string","description":"Numer dokumentu podmiotu powiazanego"},"nationality":{"type":"array","description":"Obywatelstwo podmiotu powiazanego","example":["PL","EN"],"items":{"type":"string"}},"nip":{"type":"string","description":"NIP podmiotu powiazanego - obligatoryjne, gdy osoba prawna","example":"7172693263"},"regon":{"type":"string","description":"Regon podmiotu powiazanego"},"consentIssueDate":{"type":"string","description":"Data wyrazenia zgody 1.1 - obligatoryjne, gdy osoba fizyczna","format":"date"}}},"KlopsVerificationTransactionOutput":{"type":"object","properties":{"verificationId":{"type":"string","description":"Identyfikator weryfikacji"},"transactionId":{"type":"string","description":"Numer transakcji"},"verificationResult":{"$ref":"#/components/schemas/Signal"},"affiliatedEntities":{"type":"array","description":"Lista wynikow zapytan CRIF","items":{"$ref":"#/components/schemas/KlopsVerificationTransactionQueryResult"}}}},"KlopsVerificationTransactionQueryResult":{"type":"object","properties":{"queryId":{"type":"string","description":"Id zapytania do CRIF","example":"1"},"queryType":{"$ref":"#/components/schemas/QueryType"},"result":{"$ref":"#/components/schemas/Signal"},"warnings":{"type":"array","description":"Lista ostrzezen","items":{"type":"string"}},"reportUrl":{"type":"string","description":"Link do raportu ze szczegolowym raportem"},"queryIdentifiers":{"type":"array","description":"Parametry wejściowe zapytania CRIF","items":{"$ref":"#/components/schemas/KlopsQueryIdentifier"}}}},"QueryType":{"type":"string","description":"Typ odpytania (po firmie, po osobie itp.)","enum":["PERSON","COMPANY","COMPANY_SUPPLIER"]},"LegalForm":{"type":"integer","description":"# Forma prawna\n1 - Spolka z Ograniczona Odpowiedzialnoscia\n\n2 - Spolka Akcyjna\n\n3 - Spolka Cywilna\n\n4 - Spolka Jawna\n\n5 - Spolka Komandytowa\n\n6 - Przedsiebiorstwo Panstwowe\n\n7 - Spoldzielnia\n\n9 - Szkola\n\n10 - Fundacja\n\n11 - Stowarzyszenie\n\n22 - Osoba fizyczna prowadzaca indywidualna dzialalnosc gospodarcza\n\n23 - Spolka komandytowo-akcyjna\n\n24 - Spolka partnerska\n\n25 - Samorzad Terytorialny\n\n26 - Podmiot Zagraniczny\n\n27 - Organ administracji rzadowej\n\n28 - Sp. z o.o. Spolka komandytowa\n","example":2,"enum":[1,2,3,4,5,6,7,9,10,11,22,23,24,25,26,27,28]},"KlopsQueryIdentifier":{"type":"object","properties":{"identifierName":{"$ref":"#/components/schemas/KlopsQueryIdentifierTypeName"},"identifierValue":{"type":"string","description":"Wartość identyfikatora wykorzystywanego przy zapytaniu do CRIF"}}},"KlopsQueryIdentifierTypeName":{"type":"string","description":"Nazwa typu identyfikatora wykorzystywanego w zapytaniu do CRIF","example":"CLIENT_NIP","enum":["CLIENT_NIP","SUPPLIER_NIP","ENTITY_NIP","ENTITY_PESEL"]},"DocumentTypeEnum":{"type":"string","description":"Rodzaj dokumentu tożsamości","enum":["ID_CARD","PASSPORT","PL_RESIDENCE_PERMIT_CARD_ID"]}}}}